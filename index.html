<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokémon TCG Tracker - Retro UI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <script type="module">
        // --- Firebase SDKs ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // --- DOM References ---
        const searchInput = document.getElementById('searchInput');
        const resultsContainer = document.getElementById('results');
        const imageModal = document.getElementById('imageModal');
        const modalImage = document.getElementById('modalImage');
        const closeModalButton = document.getElementById('closeModal');
        const progressText = document.getElementById('progressText');
        const progressBar = document.getElementById('progressBar');
        const showListBtn = document.getElementById('showListBtn');
        const myListPanel = document.getElementById('myListPanel');
        const panelOverlay = document.getElementById('panel-overlay');
        const myListContainer = document.getElementById('myListContainer');
        const toastContainer = document.getElementById('toast-container');
        const userDisplay = document.getElementById('userDisplay');
        const logoutBtn = document.getElementById('logoutBtn');
        const gridViewBtn = document.getElementById('gridViewBtn');
        const listViewBtn = document.getElementById('listViewBtn');
        const loginModal = document.getElementById('loginModal');
        const loginForm = document.getElementById('loginForm');
        const emailInput = document.getElementById('emailInput');
        const passwordInput = document.getElementById('passwordInput');
        const loginError = document.getElementById('loginError');
        const loginTitle = document.getElementById('loginTitle');
        const loginSubmitBtn = document.getElementById('loginSubmitBtn');
        const toggleAuthMode = document.getElementById('toggleAuthMode');
        const autocompleteResults = document.getElementById('autocomplete-results');
        const statusDisplay = document.getElementById('statusDisplay');


        // --- State and Config ---
        const API_ENDPOINT = 'https://api.pokemontcg.io/v2/cards';
        const TOTAL_POKEMON = 1025; 
        let completionList = [];
        let currentUser = null;
        let unsubscribeFromCollection = null;
        let currentView = 'grid';
        let lastDisplayedCards = [];
        let isRegistering = false;
        let suggestionTimeout;

        // --- Firebase Initialization ---
        const firebaseConfig = {
          apiKey: "AIzaSyBqKvL31__K5UZo-iwjO7uN5zPN4t8aDn4",
          authDomain: "poke-c7d03.firebaseapp.com",
          projectId: "poke-c7d03",
          storageBucket: "poke-c7d03.appspot.com",
          messagingSenderId: "567243781113",
          appId: "1:567243781113:web:53c5a8e442b4967cdb4328"
        };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = firebaseConfig.appId;

        // --- UI Functions ---
        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerHTML = message;
            toastContainer.innerHTML = ''; 
            toastContainer.appendChild(toast);
        }

        function toggleListPanel(open) {
            if (open) {
                if (!currentUser) {
                    showToast("Please log in to manage a list.");
                    return;
                }
                renderCompletionList();
                panelOverlay.classList.remove('hidden');
                myListPanel.classList.add('open');
            } else {
                panelOverlay.classList.add('hidden');
                myListPanel.classList.remove('open');
            }
        }
        
        function updateProgress() {
            const collectedCount = new Set(completionList.map(item => item.pokedex)).size;
            const percentage = (collectedCount / TOTAL_POKEMON) * 100;
            progressText.textContent = `${collectedCount}/${TOTAL_POKEMON} (${percentage.toFixed(1)}%)`;
            progressBar.style.width = `${percentage}%`;
        }

        function setActiveView(view) {
            currentView = view;
            gridViewBtn.classList.toggle('game-btn-active', view === 'grid');
            listViewBtn.classList.toggle('game-btn-active', view === 'list');
            displayCards(lastDisplayedCards);
        }
        
        function showStatus(message, isError = false) {
            statusDisplay.textContent = message;
            statusDisplay.classList.toggle('text-red-500', isError);
            if (!message) {
                 setTimeout(() => { if(statusDisplay.textContent === message) statusDisplay.textContent = ''}, 2000);
            }
        }

        // --- Firestore Data Functions ---
        async function saveCollectionToFirestore() {
            if (!currentUser) return;
            try {
                const userDocRef = doc(db, "artifacts", appId, "users", currentUser.uid, "collection", "data");
                await setDoc(userDocRef, { list: completionList });
            } catch (error) {
                console.error("Error saving collection: ", error);
                showToast("SAVE FAILED! Check console (F12) for errors.");
            }
        }

        function listenToCollection(userId) {
            if (unsubscribeFromCollection) unsubscribeFromCollection();
            const userDocRef = doc(db, "artifacts", appId, "users", userId, "collection", "data");
            
            unsubscribeFromCollection = onSnapshot(userDocRef, (docSnap) => {
                completionList = docSnap.exists() ? docSnap.data().list || [] : [];
                updateProgress();
                if (myListPanel.classList.contains('open')) renderCompletionList();
                displayCards(lastDisplayedCards); // Re-render to update buttons
            }, (error) => {
                console.error("Error listening to collection:", error);
                showToast("CONNECTION LOST! Check console (F12).");
            });
        }

        // --- Core App Logic ---
        async function addToList(card) {
            if (!currentUser) {
                showToast("Please log in to save cards.");
                return;
            }
            const pokedexNumber = card.nationalPokedexNumbers?.[0];
            if (!pokedexNumber) return;

            if (!completionList.some(item => item.pokedex === pokedexNumber)) {
                const newEntry = {
                    pokedex: pokedexNumber,
                    name: card.name.split('-')[0].trim(),
                    image: card.images.small
                };
                completionList.push(newEntry);
                await saveCollectionToFirestore();
                showToast(`Registered ${newEntry.name} to your list!`);
            }
        }

        async function removeFromList(pokedexNumber) {
            if (!currentUser) return;
            const removedItem = completionList.find(item => item.pokedex === pokedexNumber);
            completionList = completionList.filter(item => item.pokedex !== pokedexNumber);
            await saveCollectionToFirestore();
            if (removedItem) showToast(`${removedItem.name} was removed from the list.`);
        }
        
        function updateCardButton(pokedexNumber, isCollected, button) {
            button.disabled = isCollected;
            button.className = 'w-full mt-2 game-btn py-2 px-2 text-xs card-btn';
            if (currentView === 'list') {
                button.classList.add('sm:w-auto', 'sm:mt-0');
            }
            if (isCollected) {
                button.textContent = 'COLLECTED';
                button.classList.add('game-btn-success');
            } else {
                button.textContent = '> ADD';
                button.classList.add('game-btn-primary');
            }
        }

        function renderCompletionList() {
            myListContainer.innerHTML = '';
            if (completionList.length === 0) {
                myListContainer.innerHTML = `<div class="text-center p-4 text-gray-500">Your list is empty...</div>`;
                return;
            }
            const sortedList = [...completionList].sort((a, b) => a.pokedex - b.pokedex);
            sortedList.forEach(item => {
                const listItem = document.createElement('div');
                listItem.className = 'flex items-center justify-between p-2 bg-white border-2 border-black';
                listItem.innerHTML = `
                    <div class="flex items-center gap-4">
                        <img src="${item.image}" alt="${item.name}" class="w-10 h-14 object-cover border-2 border-black">
                        <div>
                            <p class="font-bold text-sm">${item.name}</p>
                            <p class="text-xs text-gray-500">#${String(item.pokedex).padStart(3, '0')}</p>
                        </div>
                    </div>
                    <button class="remove-btn text-red-500 hover:text-red-700 text-2xl">[X]</button>`;
                listItem.querySelector('.remove-btn').onclick = () => removeFromList(item.pokedex);
                myListContainer.appendChild(listItem);
            });
        }
        
        // --- NEW Live API Search Functions ---
        async function fetchAutocompleteSuggestions(query) {
            if (!query) {
                displayAutocomplete([]);
                return;
            }
            try {
                // Highly optimized query to fetch ONLY names
                const response = await fetch(`${API_ENDPOINT}?q=name:"${query}*"&select=name&pageSize=10`);
                if (!response.ok) return; // Fail silently
                const data = await response.json();
                const uniqueNames = [...new Set(data.data.map(card => card.name))].slice(0, 5);
                displayAutocomplete(uniqueNames);
            } catch (error) {
                console.warn("Autocomplete fetch failed:", error);
            }
        }
        
        async function searchApiCards(query) {
            if (!query) {
                resultsContainer.innerHTML = '';
                lastDisplayedCards = [];
                return;
            }
            
            showStatus('SEARCHING...');
            resultsContainer.innerHTML = ''; // Clear previous results immediately
            
            const isPokedexNumber = /^\d+$/.test(query);
            let apiQuery;
            if (isPokedexNumber) {
                apiQuery = `nationalPokedexNumbers:${query}`;
            } else {
                // Use quotes for an exact name match to get all variants
                apiQuery = `name:"${query}"`;
            }

            try {
                // Optimized query to get essential data for up to 50 cards
                const selectFields = 'id,name,images,nationalPokedexNumbers';
                const response = await fetch(`${API_ENDPOINT}?q=${apiQuery}&select=${selectFields}&pageSize=50&orderBy=set.releaseDate`);
                
                if (!response.ok) {
                   throw new Error(`API Error: ${response.status}`);
                }
                
                const data = await response.json();
                lastDisplayedCards = data.data || [];
                displayCards(lastDisplayedCards);
                
                if(lastDisplayedCards.length === 0) {
                    showStatus(`No cards found for "${query}".`);
                } else {
                    showStatus('');
                }

            } catch (error) {
                console.error("Card search error:", error);
                showStatus('SEARCH FAILED. Please try again.', true);
            }
        }

        // --- Display Functions ---
        function displayAutocomplete(names) {
            autocompleteResults.innerHTML = '';
            if (names.length === 0) {
                autocompleteResults.classList.add('hidden');
                return;
            }
            names.forEach(name => {
                const item = document.createElement('div');
                item.className = 'suggestion-item';
                item.textContent = name;
                item.onclick = () => {
                    searchInput.value = name;
                    autocompleteResults.classList.add('hidden');
                    searchApiCards(name); // Perform main search on click
                };
                autocompleteResults.appendChild(item);
            });
            autocompleteResults.classList.remove('hidden');
        }

        function displayCards(cards) {
            resultsContainer.innerHTML = '';
            if (cards.length === 0) {
                return;
            }
            if (currentView === 'grid') {
                resultsContainer.className = 'grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6';
                cards.forEach(displayCardAsGrid);
            } else {
                resultsContainer.className = 'space-y-4';
                cards.forEach(displayCardAsList);
            }
        }
        
        function createCardElement(card, template) {
            const cardElement = document.createElement('div');
            cardElement.innerHTML = template;

            const pokedexNumber = card.nationalPokedexNumbers?.[0];
            const isCollected = currentUser && pokedexNumber ? completionList.some(item => item.pokedex === pokedexNumber) : false;

            const img = cardElement.querySelector('.card-image');
            const imageContainer = cardElement.querySelector('.img-placeholder');

            if(img && imageContainer) {
                const imageLoader = new Image();
                imageLoader.src = card.images.small;
                imageLoader.onload = () => {
                    img.src = imageLoader.src;
                    img.classList.remove('opacity-0');
                    imageContainer.classList.remove('img-placeholder');
                };
                imageLoader.onerror = () => {
                    imageContainer.innerHTML = `<div class="w-full h-full flex items-center justify-center text-xs text-center p-2">Image not found</div>`;
                };
            }
            
            if (img) {
                img.addEventListener('click', () => {
                    modalImage.src = card.images.large;
                    imageModal.classList.remove('hidden');
                });
            }

            const addButton = cardElement.querySelector('.card-btn');
            if (pokedexNumber && addButton) {
                updateCardButton(pokedexNumber, isCollected, addButton);
                addButton.onclick = () => addToList(card);
            } else if (addButton) {
                addButton.remove();
            }

            return cardElement.firstElementChild;
        }

        function displayCardAsGrid(card) {
            const template = `
                <div class="text-center">
                    <div class="img-placeholder">
                        <img alt="${card.name}" class="card-image w-full border-4 border-black cursor-pointer opacity-0 transition-opacity duration-500" loading="lazy">
                    </div>
                    <div class="mt-2 text-xs">
                        <p class="font-bold truncate">${card.name}</p>
                    </div>
                    <button data-pokedex="${card.nationalPokedexNumbers?.[0]}" class="card-btn"></button>
                </div>
            `;
            const cardElement = createCardElement(card, template);
            resultsContainer.appendChild(cardElement);
        }
        
        function displayCardAsList(card) {
            const template = `
                <div class="game-box p-3 flex flex-col sm:flex-row items-center gap-4">
                    <div class="img-placeholder w-20 h-28 flex-shrink-0">
                        <img src="${card.images.small}" alt="${card.name}" class="card-image w-20 h-28 object-cover border-2 border-black cursor-pointer opacity-0 transition-opacity duration-500" loading="lazy">
                    </div>
                    <div class="flex-grow text-center sm:text-left">
                        <p class="font-bold text-base">${card.name}</p>
                        <p class="text-xs text-gray-500">#${String(card.nationalPokedexNumbers?.[0] || 'N/A').padStart(3, '0')}</p>
                    </div>
                    <button data-pokedex="${card.nationalPokedexNumbers?.[0]}" class="card-btn"></button>
                </div>
            `;
            const cardElement = createCardElement(card, template);
            resultsContainer.appendChild(cardElement);
        }

        // --- Authentication and Session Logic ---
        function setAuthMode(isRegister) {
            isRegistering = isRegister;
            loginError.textContent = '';
            if (isRegister) {
                loginTitle.textContent = 'CREATE ACCOUNT';
                loginSubmitBtn.textContent = '> REGISTER';
                toggleAuthMode.innerHTML = 'Already have an account? <span class="underline">Login</span>';
            } else {
                loginTitle.textContent = 'PLAYER LOGIN';
                loginSubmitBtn.textContent = '> LOGIN';
                toggleAuthMode.innerHTML = 'Need an account? <span class="underline">Register</span>';
            }
        }

        async function handleAuthForm(e) {
            e.preventDefault();
            const email = emailInput.value;
            const password = passwordInput.value;
            loginError.textContent = '';

            try {
                if (isRegistering) {
                    await createUserWithEmailAndPassword(auth, email, password);
                } else {
                    await signInWithEmailAndPassword(auth, email, password);
                }
            } catch (error) {
                loginError.textContent = error.message.replace('Firebase: ', '');
            }
        }
        
        async function handleAuthState(user) {
            if (user) {
                currentUser = user;
                loginModal.classList.add('hidden');
                userDisplay.textContent = `PLAYER: ${user.email}`;
                logoutBtn.classList.remove('hidden');
                showListBtn.disabled = false;
                
                searchInput.disabled = false;
                searchInput.placeholder = "Search Name or Pokédex Nr.";
                listenToCollection(user.uid);
                searchApiCards('Pikachu');
            } else {
                currentUser = null;
                completionList = [];
                updateProgress();
                if (unsubscribeFromCollection) unsubscribeFromCollection();
                
                loginModal.classList.remove('hidden');
                userDisplay.textContent = 'LOGGED OUT';
                logoutBtn.classList.add('hidden');
                showListBtn.disabled = true;
                searchInput.disabled = true;
                searchInput.placeholder = "Please log in...";
                resultsContainer.innerHTML = '';
            }
        }

        // --- Event Listeners ---
        searchInput.addEventListener('input', e => {
            clearTimeout(suggestionTimeout);
            suggestionTimeout = setTimeout(() => {
                fetchAutocompleteSuggestions(e.target.value.trim());
            }, 300); // Debounce autocomplete
        });
        
        searchInput.addEventListener('keyup', e => {
            if (e.key === 'Enter') {
                autocompleteResults.classList.add('hidden');
                searchApiCards(searchInput.value.trim());
            }
        });

        document.addEventListener('click', (e) => {
            if (!e.target.closest('#autocomplete-container')) {
                autocompleteResults.classList.add('hidden');
            }
        });

        closeModalButton.addEventListener('click', () => imageModal.classList.add('hidden'));
        document.addEventListener('keydown', e => e.key === 'Escape' && !imageModal.classList.contains('hidden') && imageModal.classList.add('hidden'));
        showListBtn.addEventListener('click', () => toggleListPanel(true));
        panelOverlay.addEventListener('click', () => toggleListPanel(false));
        gridViewBtn.addEventListener('click', () => setActiveView('grid'));
        listViewBtn.addEventListener('click', () => setActiveView('list'));
        logoutBtn.addEventListener('click', () => signOut(auth));
        loginForm.addEventListener('submit', handleAuthForm);
        toggleAuthMode.addEventListener('click', () => setAuthMode(!isRegistering));

        // --- Initial Load ---
        function main() {
            setActiveView('grid');
            onAuthStateChanged(auth, handleAuthState);
        }

        main();
    </script>
    <style>
        html {
            -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
            image-rendering: -webkit-optimize-contrast; image-rendering: pixelated;
        }
        body { font-family: 'Press Start 2P', cursive; background-color: #e0e0e0; color: #212121; }
        .game-box { background-color: white; border: 4px solid #212121; box-shadow: 6px 6px 0px #212121; }
        .game-btn { border: 3px solid #212121; box-shadow: 4px 4px 0px #212121; transition: all 0.1s ease-in-out; text-transform: uppercase; font-size: 14px; background-color: #fff; }
        .game-btn:hover { background-color: #f0f0f0; }
        .game-btn:active, .game-btn-active { box-shadow: 0px 0px 0px #212121; transform: translate(4px, 4px); background-color: #e0e0e0;}
        .game-btn:disabled { background-color: #bdbdbd; box-shadow: none; transform: none; cursor: not-allowed; opacity: 0.7; }
        .game-btn-primary { background-color: #2979ff; color: white; }
        .game-btn-primary:hover:not(:disabled) { background-color: #2962ff; }
        .game-btn-success { background-color: #00c853; color: white; }
        .game-btn-success:hover:not(:disabled) { background-color: #00bfa5; }
        .game-input { background-color: white; border: 3px solid #212121; font-size: 16px; padding: 12px; width: 100%; }
        .game-input:focus { outline: none; border-color: #2979ff; }
        .progress-container { border: 3px solid #212121; background-color: #e0e0e0; padding: 4px; }
        .progress-bar-inner { background-color: #2979ff; transition: width 0.5s ease-out; height: 16px; }
        #toast-container { position: fixed; bottom: 0; left: 0; right: 0; z-index: 1000; pointer-events: none; }
        .toast { background-color: #212121; color: white; padding: 20px; border-top: 4px solid #9e9e9e; animation: slide-up 0.3s ease-out, slide-down 0.3s ease-in 2.7s forwards; font-size: 14px; text-align: center; }
        @keyframes slide-up { from { transform: translateY(100%); } to { transform: translateY(0); } }
        @keyframes slide-down { from { transform: translateY(0); } to { transform: translateY(100%); } }
        #myListPanel { border-left: 4px solid #212121; background-color: #f0f0f0; transition: transform 0.4s ease-in-out; transform: translateX(100%); }
        #myListPanel.open { transform: translateX(0); }
        #panel-overlay { transition: opacity 0.4s ease-in-out; backdrop-filter: blur(2px); }
        .img-placeholder {
            display: inline-block;
            width: 100%;
            aspect-ratio: 245 / 342;
            background-color: #d1d5db;
            border: 4px solid #212121;
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
         .img-placeholder.w-20 { width: 5rem; }
        @keyframes pulse { 50% { opacity: .5; } }

        /* Autocomplete styles */
        #autocomplete-container {
            position: relative;
        }
        #autocomplete-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            z-index: 50;
            background-color: white;
            border: 3px solid #212121;
            margin-top: -3px;
            max-height: 200px;
            overflow-y: auto;
        }
        .suggestion-item {
            padding: 10px 12px;
            cursor: pointer;
            border-bottom: 2px solid #e0e0e0;
            font-size: 14px;
        }
        .suggestion-item:last-child {
            border-bottom: none;
        }
        .suggestion-item:hover {
            background-color: #f0f0f0;
        }
    </style>
</head>
<body class="antialiased">
    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-70">
        <form id="loginForm" class="game-box p-8 text-center w-full max-w-sm">
            <h2 id="loginTitle" class="text-2xl font-bold mb-4">PLAYER LOGIN</h2>
            <p id="loginError" class="text-red-500 text-xs mb-4 h-4"></p>
            <input type="email" id="emailInput" class="game-input text-center mb-4" placeholder="Enter your email" required>
            <input type="password" id="passwordInput" class="game-input text-center mb-6" placeholder="Enter your password" required>
            <button id="loginSubmitBtn" type="submit" class="w-full game-btn game-btn-primary py-3">> LOGIN</button>
            <p id="toggleAuthMode" class="text-xs text-gray-500 mt-6 cursor-pointer">Need an account? <span class="underline">Register</span></p>
        </form>
    </div>

    <div class="max-w-7xl mx-auto p-4 md:p-8 relative z-10">
        <header class="text-center mb-10 p-4"><h1 class="text-3xl md:text-4xl font-black mb-2 tracking-tighter">POKéMON TCG TRACKER</h1></header>

        <div class="game-box p-4 md:p-6">
            <div class="mb-6 pb-6 border-b-4 border-dashed border-gray-300">
                <div class="flex flex-col sm:flex-row justify-between items-center gap-6">
                    <div class="w-full sm:w-2/3">
                        <div class="flex justify-between items-center mb-2 text-xs">
                            <span class="font-semibold">PROGRESS</span>
                            <span id="progressText" class="font-bold">0/1025</span>
                        </div>
                        <div class="progress-container"><div id="progressBar" class="progress-bar-inner" style="width: 0%"></div></div>
                    </div>
                    <button id="showListBtn" class="w-full sm:w-auto game-btn py-3 px-6 text-sm" disabled>> MY LIST</button>
                </div>
            </div>

            <div id="searchView">
                <div class="max-w-xl mx-auto mb-4 flex flex-col sm:flex-row gap-4 items-center">
                    <div id="autocomplete-container" class="flex-grow w-full">
                        <input type="text" id="searchInput" class="game-input text-center w-full" placeholder="Loading...">
                        <div id="autocomplete-results" class="hidden"></div>
                    </div>
                    <div class="flex gap-2">
                        <button id="gridViewBtn" title="Grid View" class="game-btn p-3">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>
                        </button>
                        <button id="listViewBtn" title="List View" class="game-btn p-3">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10zm0 5.25a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75z" clip-rule="evenodd"></path></svg>
                        </button>
                    </div>
                </div>
                <div id="statusDisplay" class="text-center text-gray-500 text-xs py-2"></div>
                <main id="results" class="gap-6"></main>
            </div>
        </div>

        <footer class="text-center mt-4">
            <div class="flex items-center justify-center gap-4">
                 <p id="userDisplay" class="text-gray-500 text-xs"></p>
                 <button id="logoutBtn" class="hidden game-btn text-xs py-1 px-2 border-2 shadow-sm active:translate-y-0.5 active:shadow-none">> LOGOUT</button>
            </div>
        </footer>
    </div>
    
    <div id="imageModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4 bg-black bg-opacity-70">
        <div class="relative max-w-lg max-h-full game-box p-2">
            <img id="modalImage" src="" alt="Pokémon Card Large View" class="w-full">
            <button id="closeModal" class="absolute -top-4 -right-4 bg-red-500 text-white border-2 border-black h-10 w-10 font-mono text-2xl flex items-center justify-center hover:bg-red-600">[X]</button>
        </div>
    </div>

    <div id="panel-overlay" class="fixed inset-0 bg-black/30 z-30 hidden"></div>
    <aside id="myListPanel" class="fixed top-0 right-0 h-full w-full max-w-md p-6 z-40 flex flex-col">
        <div class="flex justify-between items-center mb-6 pb-4 border-b-4 border-black">
            <h2 class="text-2xl font-bold">MY LIST</h2>
            <button class="text-gray-600 hover:text-black transition-colors text-3xl" onclick="toggleListPanel(false)">[X]</button>
        </div>
        <div id="myListContainer" class="flex-grow overflow-y-auto pr-2 space-y-4"></div>
    </aside>

    <div id="toast-container"></div>
</body>
</html>
